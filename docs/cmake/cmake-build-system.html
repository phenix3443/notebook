<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-04-26 日 10:54 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>cmake build system</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="phenix3443" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script type="text/javascript" src="./script/org-info.js">

<script type="text/javascript" src="https://orgmode.org/org-info.js">
/**
 *
 * @source: https://orgmode.org/org-info.js
 *
 * @licstart  The following is the entire license notice for the
 *  JavaScript code in https://orgmode.org/org-info.js.
 *
 * Copyright (C) 2012-2019 Free Software Foundation, Inc.
 *
 *
 * The JavaScript code in this tag is free software: you can
 * redistribute it and/or modify it under the terms of the GNU
 * General Public License (GNU GPL) as published by the Free Software
 * Foundation, either version 3 of the License, or (at your option)
 * any later version.  The code is distributed WITHOUT ANY WARRANTY;
 * without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.
 *
 * As additional permission under GNU GPL version 3 section 7, you
 * may distribute non-source (e.g., minimized or compacted) forms of
 * that code without the copy of the GNU GPL normally required by
 * section 4, provided you include this license notice and a URL
 * through which recipients can access the Corresponding Source.
 *
 * @licend  The above is the entire license notice
 * for the JavaScript code in https://orgmode.org/org-info.js.
 *
 */
</script>

<script type="text/javascript">

/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/

<!--/*--><![CDATA[/*><!--*/
org_html_manager.set("TOC_DEPTH", "4");
org_html_manager.set("LINK_HOME", "https://phenix3443.github.io/");
org_html_manager.set("LINK_UP", "");
org_html_manager.set("LOCAL_TOC", "1");
org_html_manager.set("VIEW_BUTTONS", "0");
org_html_manager.set("MOUSE_HINT", "underline");
org_html_manager.set("FIXED_TOC", "0");
org_html_manager.set("TOC", "1");
org_html_manager.set("VIEW", "info");
org_html_manager.setup();  // activate after the parameters are set
/*]]>*///-->
</script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href=""> UP </a>
 |
 <a accesskey="H" href="https://phenix3443.github.io/"> HOME </a>
</div><div id="content">
<h1 class="title">cmake build system</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgbd4042a">1. 简介(Introduction)</a></li>
<li><a href="#org2137209">2. 二进制目标(Binary Targets)</a>
<ul>
<li><a href="#orga0a5ef8">2.1. 二进制执行程序(Binary Executables)</a></li>
<li><a href="#org5074948">2.2. 二进制库类型(Binary Library Types)</a>
<ul>
<li><a href="#orgc18ff90">2.2.1. 普通库(Normal Libraries)</a>
<ul>
<li><a href="#orged34262">2.2.1.1. Apple Framework</a></li>
</ul>
</li>
<li><a href="#orgce072d7">2.2.2. 对象库(Object Libraries)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org1add7ae">3. 构建规范和使用要求(Build Specification and Usage Requirements)</a>
<ul>
<li><a href="#org85dc9bc">3.1. 目标属性(Target Properties)</a></li>
<li><a href="#org708f0de">3.2. 传递使用要求(Transitive Usage Requirements)</a></li>
<li><a href="#org5685527">3.3. 兼容的接口属性(Compatible Interface Properties)</a></li>
<li><a href="#org4ceb7f4">3.4. 面向调试的属性(Property Origin Debugging)</a></li>
<li><a href="#org840bf4a">3.5. 使用生成器表达式构建规范(Build Specification with Generator Expressions)</a></li>
<li><a href="#org7b5105d">3.6. 头文件目录和使用要求(Include Directories and Usage Requirements)</a></li>
<li><a href="#org9dfdfb1">3.7. 链接库和生成表达式(Link Libraries and Generator Expressions)</a></li>
<li><a href="#org53db583">3.8. 输出(Output Artifacts)</a>
<ul>
<li><a href="#orgfe3cc23">3.8.1. 运行时输出工件（Runtime Output Artifacts）</a></li>
<li><a href="#org036d67b">3.8.2. 库输出工件（Library Output Artifacts）</a></li>
<li><a href="#org5d66ffa">3.8.3. 存档输出工件（Archive Output Artifacts）</a></li>
<li><a href="#org35dbb79">3.8.4. 目录范围命令（Directory-Scoped Commands）</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org3cb5dd5">4. 伪目标(Pseudo Targets)</a>
<ul>
<li><a href="#org5c2216a">4.1. 导入的目标(Imported Target)</a></li>
<li><a href="#org85dde73">4.2. 别名目标(Alias Targets)</a></li>
<li><a href="#org2fcf885">4.3. 接口库(Interface Libraries)</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgbd4042a" class="outline-2">
<h2 id="orgbd4042a"><span class="section-number-2">1</span> 简介(Introduction)</h2>
<div class="outline-text-2" id="text-1">
<p>
基于 CMake 的构建系统被组织为一组高级逻辑目标。每个目标对应于一个可执行文件或库，或者是一个包含自定义命令的自定义目标。构建系统说明了目标之间的依赖关系，以此确定构建顺序和响应于变化的再生规则。
</p>
</div>
</div>

<div id="outline-container-org2137209" class="outline-2">
<h2 id="org2137209"><span class="section-number-2">2</span> 二进制目标(Binary Targets)</h2>
<div class="outline-text-2" id="text-2">
<p>
使用 <a href="https://cmake.org/cmake/help/latest/command/add_executable.html#command:add_executable">add_executable()</a> 和 <a href="https://cmake.org/cmake/help/latest/command/add_library.html#command:add_library">add_library()</a> 命令定义可执行文件和库。生成的二进制文件具有平台相关的前缀、后缀和扩展名。二进制目标之间的依赖关系使用 <a href="https://cmake.org/cmake/help/latest/command/target_link_libraries.html#command:target_link_libraries">target_link_libraries()</a> 命令表示：
</p>
<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">add_library</span>(archive archive.cpp zip.cpp lzma.cpp)
<span style="color: #ffd700;">add_executable</span>(zipapp zipapp.cpp)
<span style="color: #ffd700;">target_link_libraries</span>(zipapp archive)
</pre>
</div>
<p>
archive 被定义为静态库，包含从 archive.cpp，zip.cpp 和 lzma.cpp 编译产生的对象的归档文件。zipapp 被定义为通过编译和链接 zipapp.cpp 形成的可执行文件。zipapp 可执行文件链接时接入了 archive 静态库。
</p>
</div>

<div id="outline-container-orga0a5ef8" class="outline-3">
<h3 id="orga0a5ef8"><span class="section-number-3">2.1</span> 二进制执行程序(Binary Executables)</h3>
<div class="outline-text-3" id="text-2-1">
<p>
<a href="https://cmake.org/cmake/help/latest/command/add_executable.html#command:add_executable">add_executable()</a> 命令定义一个可执行目标：
</p>
<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">add_executable</span>(mytool mytool.cpp)
</pre>
</div>
<p>
有些命令（如 <a href="https://cmake.org/cmake/help/latest/command/add_custom_command.html#command:add_custom_command">add_custom_command()</a>）生成可在构建时运行的规则，这些命令可以透明地使用可执行目标作为 COMMAND 可执行文件。构建系统规则将确保在尝试运行命令之前构建可执行文件。
</p>
</div>
</div>

<div id="outline-container-org5074948" class="outline-3">
<h3 id="org5074948"><span class="section-number-3">2.2</span> 二进制库类型(Binary Library Types)</h3>
<div class="outline-text-3" id="text-2-2">
</div>
<div id="outline-container-orgc18ff90" class="outline-4">
<h4 id="orgc18ff90"><span class="section-number-4">2.2.1</span> 普通库(Normal Libraries)</h4>
<div class="outline-text-4" id="text-2-2-1">
<p>
默认情况下，<a href="https://cmake.org/cmake/help/latest/command/add_library.html#command:add_library">add_library()</a> 命令定义静态库，除非指定了一个类型。使用该命令时可以指定一个类型：
</p>
<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">add_library</span>(archive SHARED archive.cpp zip.cpp lzma.cpp)
<span style="color: #ffd700;">add_library</span>(archive STATIC archive.cpp zip.cpp lzma.cpp)
</pre>
</div>
<p>
可以启用 <a href="https://cmake.org/cmake/help/latest/variable/BUILD_SHARED_LIBS.html#variable:BUILD_SHARED_LIBS">BUILD_SHARED_LIBS</a> 变量让 <a href="https://cmake.org/cmake/help/v3.10/command/add_library.html#command:add_library">add_library()</a> 默认构建共享库。
</p>

<p>
在整个构建系统定义的上下文中，特定库是 SHARED 还是 STATIC 很大程度上无关紧要 - 无论何种库类型，命令，依赖规范和其他 API 的工作方式都相似。
</p>

<p>
但 MODULE 库类型不同，因为它通常不用来链接，也就是说它不用在 <a href="https://cmake.org/cmake/help/latest/command/target_link_libraries.html#command:target_link_libraries">target_link_libraries()</a> 命令的右侧。它是一种使用运行时技术作为插件加载的类型。如果库不导出任何非托管符号（例如 Windows 资源 DLL，C++/CLI DLL），则要求该库不是 SHARED 库，因为 CMake 希望 SHARED 库导出至少一个符号。
</p>
<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">add_library</span>(archive MODULE 7z.cpp)
</pre>
</div>
</div>

<div id="outline-container-orged34262" class="outline-5">
<h5 id="orged34262"><span class="section-number-5">2.2.1.1</span> Apple Framework</h5>
<div class="outline-text-5" id="text-2-2-1-1">
<p>
可以用 FRAMEWORK 目标属性标记 SHARED 库来创建 OS X 或 iOS Framework Bundle。MACOSX_FRAMEWORK_IDENTIFIER 设置 CFBundleIdentifier 密钥，它唯一标识该 bundle。
</p>
<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">add_library</span>(MyFramework SHARED MyFramework.cpp)
<span style="color: #ffd700;">set_target_properties</span>(MyFramework PROPERTIES
  FRAMEWORK TRUE
  FRAMEWORK_VERSION A
  MACOSX_FRAMEWORK_IDENTIFIER org.cmake.MyFramework
)
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgce072d7" class="outline-4">
<h4 id="orgce072d7"><span class="section-number-4">2.2.2</span> 对象库(Object Libraries)</h4>
<div class="outline-text-4" id="text-2-2-2">
<p>
OBJECT 库类型也不用来链接。它定义了编译给定源文件所产生的目标文件的非归档集合。目标文件集合可以用作其他目标的源输入：
</p>
<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">add_library</span>(archive OBJECT archive.cpp zip.cpp lzma.cpp)
<span style="color: #ffd700;">add_library</span>(archiveExtras STATIC $&lt;TARGET_OBJECTS:archive&gt; extras.cpp)
<span style="color: #ffd700;">add_executable</span>(test_exe $&lt;TARGET_OBJECTS:archive&gt; test.cpp)
</pre>
</div>
<p>
OBJECT 库不能用在 <a href="https://cmake.org/cmake/help/v3.10/command/target_link_libraries.html#command:target_link_libraries">target_link_libraries()</a> 的右侧。在使用 <a href="https://cmake.org/cmake/help/v3.10/command/add_custom_command.html#command:add_custom_command">add_custom_command(TARGET)</a> 命令签名时，它们也不能用作 TARGET。它们可被安装，并作为 INTERFACE 库导出。
</p>

<p>
尽管调用 <a href="https://cmake.org/cmake/help/v3.10/command/target_link_libraries.html#command:target_link_libraries">target_link_libraries()</a> 命令时不能直接命名对象库，但可以通过使用 <a href="https://cmake.org/cmake/help/v3.10/manual/cmake-buildsystem.7.html#interface-libraries">接口库</a> 间接“链接”，该接口库的 <a href="https://cmake.org/cmake/help/v3.10/prop_tgt/INTERFACE_SOURCES.html#prop_tgt:INTERFACE_SOURCES">INTERFACE_SOURCES</a> 目标属性设置为名称 <code>$&lt;TARGET_OBJECTS：objlib&gt;</code> 。
</p>

<p>
尽管在使用 <a href="https://cmake.org/cmake/help/v3.10/command/add_custom_command.html#command:add_custom_command">add_custom_command(TARGET)</a> 命令签名时，对象库不能用作 TARGET，但 <a href="https://cmake.org/cmake/help/v3.10/command/add_custom_command.html#command:add_custom_command">add_custom_command(OUTPUT)</a> 或 <a href="https://cmake.org/cmake/help/v3.10/command/file.html#command:file">file(GENERATE)</a> 可通过 <code>$&lt;TARGET_OBJECTS：objlib&gt;</code>  来使用对象列表。
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org1add7ae" class="outline-2">
<h2 id="org1add7ae"><span class="section-number-2">3</span> 构建规范和使用要求(Build Specification and Usage Requirements)</h2>
<div class="outline-text-2" id="text-3">
<p>
<a href="https://cmake.org/cmake/help/latest/command/target_include_directories.html#command:target_include_directories">target_include_directories()</a>，<a href="https://cmake.org/cmake/help/latest/command/target_compile_definitions.html#command:target_compile_definitions">target_compile_definitions()</a> 和 <a href="https://cmake.org/cmake/help/latest/command/target_compile_options.html#command:target_compile_options">target_compile_options()</a> 命令指定了二进制目标的构建规范和使用要求。这些命令分别填充 <a href="https://cmake.org/cmake/help/latest/prop_tgt/INCLUDE_DIRECTORIES.html#prop_tgt:INCLUDE_DIRECTORIES">INCLUDE_DIRECTORIES</a>， <a href="https://cmake.org/cmake/help/latest/prop_tgt/COMPILE_DEFINITIONS.html#prop_tgt:COMPILE_DEFINITIONS">COMPILE_DEFINITIONS</a> 和 <a href="https://cmake.org/cmake/help/latest/prop_tgt/COMPILE_OPTIONS.html#prop_tgt:COMPILE_OPTIONS">COMPILE_OPTIONS</a> 目标属性，可能还有 <a href="https://cmake.org/cmake/help/latest/prop_tgt/INTERFACE_INCLUDE_DIRECTORIES.html#prop_tgt:INTERFACE_INCLUDE_DIRECTORIES">INTERFACE_INCLUDE_DIRECTORIES</a>， <a href="https://cmake.org/cmake/help/latest/prop_tgt/INTERFACE_COMPILE_DEFINITIONS.html#prop_tgt:INTERFACE_COMPILE_DEFINITIONS">INTERFACE_COMPILE_DEFINITIONS</a> 和 <a href="https://cmake.org/cmake/help/latest/prop_tgt/INTERFACE_COMPILE_OPTIONS.html#prop_tgt:INTERFACE_COMPILE_OPTIONS">INTERFACE_COMPILE_OPTIONS</a> 目标属性。
</p>

<p>
每个命令都有一个 PRIVATE，PUBLIC 和 INTERFACE 模式。PRIVATE 模式仅填充目标属性的非 INTERFACE_变体，而 INTERFACE 模式仅填充 INTERFACE_变体。PUBLIC 模式填充相应目标属性的两个变体。每个命令都可以通过多次使用每个关键字来调用：
</p>
<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">target_compile_definitions</span>(archive
  PRIVATE BUILDING_WITH_LZMA
  INTERFACE USING_ARCHIVE_LIB
)
</pre>
</div>
<p>
请注意，使用要求不是为了方便使下游使用特定的 <a href="https://cmake.org/cmake/help/v3.10/prop_tgt/COMPILE_OPTIONS.html#prop_tgt:COMPILE_OPTIONS">COMPILE_OPTIONS</a> 或 <a href="https://cmake.org/cmake/help/v3.10/prop_tgt/COMPILE_DEFINITIONS.html#prop_tgt:COMPILE_DEFINITIONS">COMPILE_DEFINITIONS</a> 等。这些属性的内容是必须要求的，而不仅仅是建议或便利。
</p>

<p>
关在创建重新分发包时指定使用要求时必须采取的额外注意事项的讨论，请参阅 <a href="https://cmake.org/cmake/help/v3.10/manual/cmake-packages.7.html#manual:cmake-packages(7)">cmake-packages(7)</a> 手册的 <a href="https://cmake.org/cmake/help/v3.10/manual/cmake-packages.7.html#creating-relocatable-packages">“创建可重定位包”</a> 部分。
</p>
</div>

<div id="outline-container-org85dc9bc" class="outline-3">
<h3 id="org85dc9bc"><span class="section-number-3">3.1</span> 目标属性(Target Properties)</h3>
<div class="outline-text-3" id="text-3-1">
<p>
在编译二进制目标的源文件时，要正确使用 <a href="https://cmake.org/cmake/help/v3.10/prop_tgt/INCLUDE_DIRECTORIES.html#prop_tgt:INCLUDE_DIRECTORIES">INCLUDE_DIRECTORIES</a>，<a href="https://cmake.org/cmake/help/v3.10/prop_tgt/COMPILE_DEFINITIONS.html#prop_tgt:COMPILE_DEFINITIONS">COMPILE_DEFINITIONS</a> 和 <a href="https://cmake.org/cmake/help/v3.10/prop_tgt/COMPILE_OPTIONS.html#prop_tgt:COMPILE_OPTIONS">COMPILE_OPTIONS</a> 目标属性的内容。
</p>

<p>
INCLUDE_DIRECTORIES 中的条目使用 <code>-I</code> 或 <code>-isystem</code> 前缀，按照属性值中的出现顺序添加到编译行中。
</p>

<p>
COMPILE_DEFINITIONS 中的条目使用前缀为 <code>-D</code> 或 <code>/D</code> ，并以未指定的顺序添加到编译行中。对于 SHARED 和 MODULE 库目标，出于方便，<a href="https://cmake.org/cmake/help/latest/prop_tgt/DEFINE_SYMBOL.html#prop_tgt:DEFINE_SYMBOL">DEFINE_SYMBOL</a> 目标属性也作为编译定义添加。
</p>

<p>
COMPILE_OPTIONS 中的条目针对 shell 进行转义，并按照属性值中的出现顺序添加。几个编译选项有特殊的单独处理，如 <a href="https://cmake.org/cmake/help/latest/prop_tgt/POSITION_INDEPENDENT_CODE.html#prop_tgt:POSITION_INDEPENDENT_CODE">POSITION_INDEPENDENT_CODE</a>。
</p>

<p>
INTERFACE_INCLUDE_DIRECTORIES, INTERFACE_COMPILE_DEFINITIONS 和 INTERFACE_COMPILE_OPTIONS 三个目标属性的内容是使用要求(Usage Requirements)，它们指定了正确编译和链接该目标时需要遵循的内容。任何二进制目标，都使用 target_link_libraries() 中指定的每个目标的 INTERFACE_ 属性。
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">set</span>(srcs archive.cpp zip.cpp)
<span style="color: #a1db00;">if</span> (LZMA_FOUND)
  <span style="color: #ffd700;">list</span>(APPEND srcs lzma.cpp)
<span style="color: #a1db00;">endif</span>()
<span style="color: #ffd700;">add_library</span>(archive SHARED ${<span style="color: #ff8700;">srcs</span>})
<span style="color: #a1db00;">if</span> (LZMA_FOUND)
  <span style="color: #6c6c6c; font-style: italic;"># The archive library sources are compiled with -DBUILDING_WITH_LZMA</span>
  <span style="color: #ffd700;">target_compile_definitions</span>(archive PRIVATE BUILDING_WITH_LZMA)
<span style="color: #a1db00;">endif</span>()
<span style="color: #ffd700;">target_compile_definitions</span>(archive INTERFACE USING_ARCHIVE_LIB)

<span style="color: #ffd700;">add_executable</span>(consumer)
<span style="color: #6c6c6c; font-style: italic;"># Link consumer to archive and consume its usage requirements. The consumer</span>
<span style="color: #6c6c6c; font-style: italic;"># executable sources are compiled with -DUSING_ARCHIVE_LIB.</span>
<span style="color: #ffd700;">target_link_libraries</span>(consumer archive)

</pre>
</div>
<p>
因为通常要求将源目录和相应的编译目录添加到 <a href="https://cmake.org/cmake/help/v3.10/prop_tgt/INCLUDE_DIRECTORIES.html#prop_tgt:INCLUDE_DIRECTORIES">INCLUDE_DIRECTORIES</a> 中，可以启用 <a href="https://cmake.org/cmake/help/latest/variable/CMAKE_INCLUDE_CURRENT_DIR.html#variable:CMAKE_INCLUDE_CURRENT_DIR">CMAKE_INCLUDE_CURRENT_DIR</a> 变量来方便地将相应的目录添加到所有目标的 INCLUDE_DIRECTORIES 中。可以启用变量 <a href="https://cmake.org/cmake/help/latest/variable/CMAKE_INCLUDE_CURRENT_DIR_IN_INTERFACE.html#variable:CMAKE_INCLUDE_CURRENT_DIR_IN_INTERFACE">CMAKE_INCLUDE_CURRENT_DIR_IN_INTERFACE</a>，将相应的目录添加到所有目标的 INTERFACE_INCLUDE_DIRECTORIES 中。这使得通过使用 <a href="https://cmake.org/cmake/help/v3.10/command/target_link_libraries.html#command:target_link_libraries">target_link_libraries()</a> 命令方便地使用多个不同目录中的目标。
</p>
</div>
</div>

<div id="outline-container-org708f0de" class="outline-3">
<h3 id="org708f0de"><span class="section-number-3">3.2</span> 传递使用要求(Transitive Usage Requirements)</h3>
<div class="outline-text-3" id="text-3-2">
<p>
依赖项目标的使用需求可以传递给使用者。target_link_libraries()命令具有 PRIVATE，INTERFACE 和 PUBLIC 关键字来控制传播。
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">add_library</span>(archive archive.cpp)
<span style="color: #ffd700;">target_compile_definitions</span>(archive INTERFACE USING_ARCHIVE_LIB)

<span style="color: #ffd700;">add_library</span>(serialization serialization.cpp)
<span style="color: #ffd700;">target_compile_definitions</span>(serialization INTERFACE USING_SERIALIZATION_LIB)

<span style="color: #ffd700;">add_library</span>(archiveExtras extras.cpp)
<span style="color: #ffd700;">target_link_libraries</span>(archiveExtras PUBLIC archive)
<span style="color: #ffd700;">target_link_libraries</span>(archiveExtras PRIVATE serialization)
<span style="color: #6c6c6c; font-style: italic;"># archiveExtras is compiled with -DUSING_ARCHIVE_LIB</span>
<span style="color: #6c6c6c; font-style: italic;"># and -DUSING_SERIALIZATION_LIB</span>

<span style="color: #ffd700;">add_executable</span>(consumer consumer.cpp)
<span style="color: #6c6c6c; font-style: italic;"># consumer is compiled with -DUSING_ARCHIVE_LIB</span>
<span style="color: #ffd700;">target_link_libraries</span>(consumer archiveExtras)
</pre>
</div>

<p>
由于 <code>archive</code> 是 <code>archiveExtras</code> 的 <code>PUBLIC</code> 依赖项，因此它的使用需求也会传播给 <code>consumer</code> 。由于 <code>serialization</code> 是 <code>archiveExtras</code> 的 PRIVATE 依赖项，因此它的使用要求不会传播给 <code>consumer</code> 。
</p>

<p>
通常，如果只使用库的实现而不使用头文件，使用 <a href="https://cmake.org/cmake/help/v3.10/command/target_link_libraries.html#command:target_link_libraries">target_link_libraries()</a> 时应该在使用 PRIVATE 关键字来指定依赖项。
</p>

<p>
如果还使用了依赖库的头文件(例如，用于类继承)，则应该将其指定为 PUBLIC 依赖项。
</p>

<p>
只使用了依赖库的头文件而没有使用实现，应该指定为一个 INTERFACE 依赖。target_link_libraries() 命令调用时可以通过使用多个关键字：
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">target_link_libraries</span>(archiveExtras
  PUBLIC archive
  PRIVATE serialization
)
</pre>
</div>

<p>
通过从依赖项中读取目标属性的INTERFACE_变体并将值附加到操作数的非INTERFACE_变体来传播使用要求。例如，读取依赖项的 INTERFACE_INCLUDE_DIRECTORIES 并附加到操作数的 INCLUDE_DIRECTORIES。 在顺序相关和需要维护的情况下，由于 target_link_libraries() 调用产生的顺序或许不能正确编译，使用合适的命令直接设置属性可以更新顺序。
</p>

<p>
例如，如果目标的链接库必须以 lib1 lib2 lib3 的顺序指定，但 include 目录的顺序必须指定为 lib3 lib1 lib2 ：
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">target_link_libraries</span>(myExe lib1 lib2 lib3)
<span style="color: #ffd700;">target_include_directories</span>(myExe
  PRIVATE $&lt;TARGET_PROPERTY:lib3,INTERFACE_INCLUDE_DIRECTORIES&gt;)
</pre>
</div>

<p>
请注意，在使用 <a href="https://cmake.org/cmake/help/latest/command/install.html#command:install">install(EXPORT)</a> 令指定将导出以进行安装的目标的使用要求时，必须小心。参见 <a href="https://cmake.org/cmake/help/v3.10/manual/cmake-packages.7.html#creating-packages">Creating Packages</a> 。
</p>
</div>
</div>

<div id="outline-container-org5685527" class="outline-3">
<h3 id="org5685527"><span class="section-number-3">3.3</span> 兼容的接口属性(Compatible Interface Properties)</h3>
<div class="outline-text-3" id="text-3-3">
<p>
有些目标属性要求目标和每个依赖的接口保持兼容性。例如，POSITION_INDEPENDENT_CODE 目标属性可以指定目标是否应被编译为与位置无关的代码的布尔值，其具有平台特定的结果。目标也可以指定使用要求 INTERFACE_POSITION_INDEPENDENT_CODE 来传达使用者必须被编译为位置无关代码。
</p>
<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">add_executable</span>(exe1 exe1.cpp)
<span style="color: #ffd700;">set_property</span>(TARGET exe1 PROPERTY POSITION_INDEPENDENT_CODE ON)

<span style="color: #ffd700;">add_library</span>(lib1 SHARED lib1.cpp)
<span style="color: #ffd700;">set_property</span>(TARGET lib1 PROPERTY INTERFACE_POSITION_INDEPENDENT_CODE ON)

<span style="color: #ffd700;">add_executable</span>(exe2 exe2.cpp)
<span style="color: #ffd700;">target_link_libraries</span>(exe2 lib1)
</pre>
</div>

<p>
此处，exe1 和 exe2 将被编译为位置无关的代码。lib1 也将被编译为位置无关的代码，因为这是 SHARED 库的默认设置。如果依赖关系冲突，则不兼容的需求发出一个诊断信息：
</p>
<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">add_library</span>(lib1 SHARED lib1.cpp)
<span style="color: #ffd700;">set_property</span>(TARGET lib1 PROPERTY INTERFACE_POSITION_INDEPENDENT_CODE ON)

<span style="color: #ffd700;">add_library</span>(lib2 SHARED lib2.cpp)
<span style="color: #ffd700;">set_property</span>(TARGET lib2 PROPERTY INTERFACE_POSITION_INDEPENDENT_CODE OFF)

<span style="color: #ffd700;">add_executable</span>(exe1 exe1.cpp)
<span style="color: #ffd700;">target_link_libraries</span>(exe1 lib1)
<span style="color: #ffd700;">set_property</span>(TARGET exe1 PROPERTY POSITION_INDEPENDENT_CODE OFF)

<span style="color: #ffd700;">add_executable</span>(exe2 exe2.cpp)
<span style="color: #ffd700;">target_link_libraries</span>(exe2 lib1 lib2)
</pre>
</div>
<p>
lib1 要求 INTERFACE_POSITION_INDEPENDENT_CODE 与 exe1 目标的 POSITION_INDEPENDENT_CODE 属性不“兼容”。该库要求使用者构建为位置无关代码，而可执行文件指定不构建为位置无关代码，所以发生了诊断。
</p>

<p>
lib1 和 lib2 的要求不是“兼容的”。其中之一要求消费者被建立为与位置无关的代码，而另一个则要求消费者不被建立为与位置无关的代码。因为 exe2 链接到两者并且它们有冲突，所以发布诊断。
</p>

<p>
为了“兼容”，POSITION_INDEPENDENT_CODE 属性(如果设置)，必须与依赖项的传递的 INTERFACE_POSITION_INDEPENDENT_CODE 属性布尔意义上相同。
</p>

<p>
通过在 COMPATIBLE_INTERFACE_BOOL 目标属性的内容中指定属性，可以将“兼容接口要求”的这个属性扩展到其他属性。每个指定的属性必须在消费目标和每个依赖项对应的 INTERFACE_前缀属性之间兼容：
</p>
<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">add_library</span>(lib1Version2 SHARED lib1_v2.cpp)
<span style="color: #ffd700;">set_property</span>(TARGET lib1Version2 PROPERTY INTERFACE_CUSTOM_PROP ON)
<span style="color: #ffd700;">set_property</span>(TARGET lib1Version2 APPEND PROPERTY
  COMPATIBLE_INTERFACE_BOOL CUSTOM_PROP
)

<span style="color: #ffd700;">add_library</span>(lib1Version3 SHARED lib1_v3.cpp)
<span style="color: #ffd700;">set_property</span>(TARGET lib1Version3 PROPERTY INTERFACE_CUSTOM_PROP OFF)

<span style="color: #ffd700;">add_executable</span>(exe1 exe1.cpp)
<span style="color: #ffd700;">target_link_libraries</span>(exe1 lib1Version2) <span style="color: #6c6c6c; font-style: italic;"># CUSTOM_PROP will be ON</span>

<span style="color: #ffd700;">add_executable</span>(exe2 exe2.cpp)
<span style="color: #ffd700;">target_link_libraries</span>(exe2 lib1Version2 lib1Version3) <span style="color: #6c6c6c; font-style: italic;"># Diagnostic</span>
</pre>
</div>
<p>
非布尔属性也可以参与“兼容接口”的计算。COMPATIBLE_INTERFACE_STRING 属性中指定的属性必须是未指定的，或者可以与所有传递指定的依赖项中的相同字符串进行比较。这可以用来确保一个库的多个不兼容版本不会通过目标的传递需求链接在一起：
</p>
<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">add_library</span>(lib1Version2 SHARED lib1_v2.cpp)
<span style="color: #ffd700;">set_property</span>(TARGET lib1Version2 PROPERTY INTERFACE_LIB_VERSION 2)
<span style="color: #ffd700;">set_property</span>(TARGET lib1Version2 APPEND PROPERTY
  COMPATIBLE_INTERFACE_STRING LIB_VERSION
)

<span style="color: #ffd700;">add_library</span>(lib1Version3 SHARED lib1_v3.cpp)
<span style="color: #ffd700;">set_property</span>(TARGET lib1Version3 PROPERTY INTERFACE_LIB_VERSION 3)

<span style="color: #ffd700;">add_executable</span>(exe1 exe1.cpp)
<span style="color: #ffd700;">target_link_libraries</span>(exe1 lib1Version2) <span style="color: #6c6c6c; font-style: italic;"># LIB_VERSION will be "2"</span>

<span style="color: #ffd700;">add_executable</span>(exe2 exe2.cpp)
<span style="color: #ffd700;">target_link_libraries</span>(exe2 lib1Version2 lib1Version3) <span style="color: #6c6c6c; font-style: italic;"># Diagnostic</span>
</pre>
</div>
<p>
COMPATIBLE_INTERFACE_NUMBER_MAX 目标属性指定将以数字方式评估的内容，以及用于计算所有指定的最大数目：
</p>
<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">add_library</span>(lib1Version2 SHARED lib1_v2.cpp)
<span style="color: #ffd700;">set_property</span>(TARGET lib1Version2 PROPERTY INTERFACE_CONTAINER_SIZE_REQUIRED 200)
<span style="color: #ffd700;">set_property</span>(TARGET lib1Version2 APPEND PROPERTY
  COMPATIBLE_INTERFACE_NUMBER_MAX CONTAINER_SIZE_REQUIRED
)

<span style="color: #ffd700;">add_library</span>(lib1Version3 SHARED lib1_v3.cpp)
<span style="color: #ffd700;">set_property</span>(TARGET lib1Version3 PROPERTY INTERFACE_CONTAINER_SIZE_REQUIRED 1000)

<span style="color: #ffd700;">add_executable</span>(exe1 exe1.cpp)
<span style="color: #6c6c6c; font-style: italic;"># CONTAINER_SIZE_REQUIRED will be "200"</span>
<span style="color: #ffd700;">target_link_libraries</span>(exe1 lib1Version2)

<span style="color: #ffd700;">add_executable</span>(exe2 exe2.cpp)
<span style="color: #6c6c6c; font-style: italic;"># CONTAINER_SIZE_REQUIRED will be "1000"</span>
<span style="color: #ffd700;">target_link_libraries</span>(exe2 lib1Version2 lib1Version3)
</pre>
</div>
<p>
同样，可以使用 COMPATIBLE_INTERFACE_NUMBER_MIN 来计算来自依赖关系的属性的数字最小值。
</p>

<p>
每个计算过“兼容”属性值可以在生成时使用生成器表达式在使用者中读取。
</p>

<p>
请注意，对于每个依赖项，每个兼容接口属性中指定的一组属性不得与任何其他属性中指定的集合相交。
</p>
</div>
</div>
<div id="outline-container-org4ceb7f4" class="outline-3">
<h3 id="org4ceb7f4"><span class="section-number-3">3.4</span> 面向调试的属性(Property Origin Debugging)</h3>
<div class="outline-text-3" id="text-3-4">
<p>
由于构建规范可以通过依赖关系来确定，因此如果没有创建目标的代码和负责构建规范的代码，可能会使代码更难以推理。cmake 提供了调试机制，可以打印由依赖项决定的属性的原始内容。可以调试的属性列在 <a href="https://cmake.org/cmake/help/v3.10/variable/CMAKE_DEBUG_TARGET_PROPERTIES.html#variable:CMAKE_DEBUG_TARGET_PROPERTIES">CMAKE_DEBUG_TARGET_PROPERTIES</a> 的文档中。
</p>
<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">set</span>(CMAKE_DEBUG_TARGET_PROPERTIES
  INCLUDE_DIRECTORIES
  COMPILE_DEFINITIONS
  POSITION_INDEPENDENT_CODE
  CONTAINER_SIZE_REQUIRED
  LIB_VERSION
)
<span style="color: #ffd700;">add_executable</span>(exe1 exe1.cpp)
</pre>
</div>
<p>
对于 <a href="https://cmake.org/cmake/help/v3.10/prop_tgt/COMPATIBLE_INTERFACE_BOOL.html#prop_tgt:COMPATIBLE_INTERFACE_BOOL">COMPATIBLE_INTERFACE_BOOL</a> 或 <a href="https://cmake.org/cmake/help/v3.10/prop_tgt/COMPATIBLE_INTERFACE_STRING.html#prop_tgt:COMPATIBLE_INTERFACE_STRING">COMPATIBLE_INTERFACE_STRING</a> 中列出的属性，调试输出显示哪个目标负责设置该属性，以及哪些依赖项也定义了该属性。在 <a href="https://cmake.org/cmake/help/v3.10/prop_tgt/COMPATIBLE_INTERFACE_NUMBER_MAX.html#prop_tgt:COMPATIBLE_INTERFACE_NUMBER_MAX">COMPATIBLE_INTERFACE_NUMBER_MAX</a> 和 <a href="https://cmake.org/cmake/help/v3.10/prop_tgt/COMPATIBLE_INTERFACE_NUMBER_MIN.html#prop_tgt:COMPATIBLE_INTERFACE_NUMBER_MIN">COMPATIBLE_INTERFACE_NUMBER_MIN</a> 的情况下，调试输出将显示每个依赖项的属性值，以及该值是否确定新的极值。
</p>
</div>
</div>

<div id="outline-container-org840bf4a" class="outline-3">
<h3 id="org840bf4a"><span class="section-number-3">3.5</span> 使用生成器表达式构建规范(Build Specification with Generator Expressions)</h3>
<div class="outline-text-3" id="text-3-5">
<p>
构建规范可以使用 <a href="https://cmake.org/cmake/help/latest/manual/cmake-generator-expressions.7.html#manual:cmake-generator-expressions(7)">生成器表达式(generator expressions)</a> ，它包含那些可能是有条件的或仅在生成时才知道的内容，例如，可以使用 <code>TARGET_PROPERTY</code> 表达式来读取计算过的属性“兼容”值：
</p>
<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">add_library</span>(lib1Version2 SHARED lib1_v2.cpp)
<span style="color: #ffd700;">set_property</span>(TARGET lib1Version2 PROPERTY
  INTERFACE_CONTAINER_SIZE_REQUIRED 200)
<span style="color: #ffd700;">set_property</span>(TARGET lib1Version2 APPEND PROPERTY
  COMPATIBLE_INTERFACE_NUMBER_MAX CONTAINER_SIZE_REQUIRED
)

<span style="color: #ffd700;">add_executable</span>(exe1 exe1.cpp)
<span style="color: #ffd700;">target_link_libraries</span>(exe1 lib1Version2)
<span style="color: #ffd700;">target_compile_definitions</span>(exe1 PRIVATE
    CONTAINER_SIZE=$&lt;TARGET_PROPERTY:CONTAINER_SIZE_REQUIRED&gt;
)
</pre>
</div>
<p>
在这种情况下，exe1 源文件将被编译为 <code>-DCONTAINER_SIZE = 200</code> 。
</p>

<p>
可以使用 <code>CONFIG</code> 生成器表达式方便地设置配置项的构建规范。
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">target_compile_definitions</span>(exe1 PRIVATE
    $&lt;$&lt;CONFIG:Debug&gt;:DEBUG_BUILD&gt;
)
</pre>
</div>
<p>
<code>CONFIG</code> 参数不区分大小写地与正在构建的配置进行比较。在存在 <code>IMPORTED</code> 目标的情况下，此表达式还会考虑 <code>MAP_IMPORTED_CONFIG_DEBUG</code> 的内容。
</p>

<p>
由 cmake(1)生成的一些构建系统在 <a href="https://cmake.org/cmake/help/v3.10/variable/CMAKE_BUILD_TYPE.html#variable:CMAKE_BUILD_TYPE">CMAKE_BUILD_TYPE</a> 变量中设置了预定的构建配置。诸如Visual Studio和Xcode之类的IDE的构建系统是独立于构建配置生成的，并且在构建时之前不知道实际的构建配置。因此，代码如:
</p>
<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">string</span>(TOLOWER ${<span style="color: #ff8700;">CMAKE_BUILD_TYPE</span>} _type)
<span style="color: #a1db00;">if</span> (_type STREQUAL debug)
  <span style="color: #ffd700;">target_compile_definitions</span>(exe1 PRIVATE DEBUG_BUILD)
<span style="color: #a1db00;">endif</span>()
</pre>
</div>
<p>
对于基于 Makefile 和 Ninja 生成器可能会工作，但不能移植到 IDE 生成器。另外，<a href="https://cmake.org/cmake/help/v3.10/prop_tgt/IMPORTED.html#prop_tgt:IMPORTED">IMPORTED</a> 的配置映射不用这样的代码来解决，所以应该避免。
</p>

<p>
一元 <code>TARGET_PROPERTY</code> 生成器表达式和 <code>TARGET_POLICY</code> 生成器表达式使用使用者的上下文进行计算。这意味着可以基于使用者计算不同的要求规范：
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">add_library</span>(lib1 lib1.cpp)
<span style="color: #ffd700;">target_compile_definitions</span>(lib1 INTERFACE
  $&lt;$&lt;STREQUAL:$&lt;TARGET_PROPERTY:TYPE&gt;,EXECUTABLE&gt;:LIB1_WITH_EXE&gt;
  $&lt;$&lt;STREQUAL:$&lt;TARGET_PROPERTY:TYPE&gt;,SHARED_LIBRARY&gt;:LIB1_WITH_SHARED_LIB&gt;
  $&lt;$&lt;TARGET_POLICY:CMP0041&gt;:CONSUMER_CMP0041_NEW&gt;
)

<span style="color: #ffd700;">add_executable</span>(exe1 exe1.cpp)
<span style="color: #ffd700;">target_link_libraries</span>(exe1 lib1)

<span style="color: #ffd700;">cmake_policy</span>(SET CMP0041 NEW)

<span style="color: #ffd700;">add_library</span>(shared_lib shared_lib.cpp)
<span style="color: #ffd700;">target_link_libraries</span>(shared_lib lib1)
</pre>
</div>
<p>
<code>exe1</code> 可执行文件将使用 <code>-DLIB1_WITH_EXE</code> 进行编译，而 <code>shared_lib</code> 共享库将使用 <code>-DLIB1_WITH_SHARED_LIB</code> 和 <code>-DCONSUMER_CMP0041_NEW</code> 进行编译，因为策略 <code>CMP0041</code> 在创建 <code>shared_lib</code> 目标时为 <code>NEW</code> 。
</p>

<p>
<code>BUILD_INTERFACE</code> 表达式包含仅在从同一构建系统中的目标使用时使用的需求，或者使用 <a href="https://cmake.org/cmake/help/v3.10/command/export.html#command:export">export()</a> 命令导出到构建目录的目标使用时使用的需求。 <code>INSTALL_INTERFACE</code> 表达式包含仅在使用 <a href="https://cmake.org/cmake/help/v3.10/command/install.html#command:install">install(EXPORT)</a> 命令安装和导出的目标使用时才使用的需求：
</p>
<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">add_library</span>(ClimbingStats climbingstats.cpp)
<span style="color: #ffd700;">target_compile_definitions</span>(ClimbingStats INTERFACE
  $&lt;BUILD_INTERFACE:ClimbingStats_FROM_BUILD_LOCATION&gt;
  $&lt;INSTALL_INTERFACE:ClimbingStats_FROM_INSTALLED_LOCATION&gt;
)
<span style="color: #ffd700;">install</span>(TARGETS ClimbingStats EXPORT libExport ${<span style="color: #ff8700;">InstallArgs</span>})
<span style="color: #ffd700;">install</span>(EXPORT libExport NAMESPACE Upstream::
        DESTINATION lib/cmake/ClimbingStats)
<span style="color: #ffd700;">export</span>(EXPORT libExport NAMESPACE Upstream::)

<span style="color: #ffd700;">add_executable</span>(exe1 exe1.cpp)
<span style="color: #ffd700;">target_link_libraries</span>(exe1 ClimbingStats)
</pre>
</div>

<p>
在这种情况下，exe1 可执行文件将使用 <code>-DClimbingStats_FROM_BUILD_LOCATION</code> 进行编译。导出命令生成的 <code>IMPORTED</code> 目标省略 <code>INSTALL_INTERFACE</code> 或 <code>BUILD_INTERFACE</code> ，并删除 <code>* _INTERFACE</code> 标记。 使用 <code>ClimbingStats</code> 包的单独项目将包含：
</p>
<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">find_package</span>(ClimbingStats REQUIRED)

<span style="color: #ffd700;">add_executable</span>(Downstream main.cpp)
<span style="color: #ffd700;">target_link_libraries</span>(Downstream Upstream::ClimbingStats)
</pre>
</div>
<p>
Downstream 根据从构建位置还是安装位置使用 ClimbingStats 软件包，将使用 <code>-DClimbingStats_FROM_BUILD_LOCATION</code> 或 <code>-DClimbingStats_FROM_INSTALL_LOCATION</code> 进行编译。
</p>
</div>
</div>
<div id="outline-container-org7b5105d" class="outline-3">
<h3 id="org7b5105d"><span class="section-number-3">3.6</span> 头文件目录和使用要求(Include Directories and Usage Requirements)</h3>
<div class="outline-text-3" id="text-3-6">
<p>
当指定为使用要求时以及与生成器表达式一起使用时，include 目录需要特别考虑。<a href="https://cmake.org/cmake/help/v3.10/command/target_include_directories.html#command:target_include_directories">target_include_directories()</a> 命令接受相对和绝对包含目录：
</p>
<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">add_library</span>(lib1 lib1.cpp)
<span style="color: #ffd700;">target_include_directories</span>(lib1 PRIVATE
  /absolute/path
  relative/path
)
</pre>
</div>

<p>
相对路径相对于命令出现的源目录进行解释。<a href="https://cmake.org/cmake/help/v3.10/prop_tgt/IMPORTED.html#prop_tgt:IMPORTED">IMPORTED</a> 目标的 <a href="https://cmake.org/cmake/help/v3.10/prop_tgt/INTERFACE_INCLUDE_DIRECTORIES.html#prop_tgt:INTERFACE_INCLUDE_DIRECTORIES">INTERFACE_INCLUDE_DIRECTORIES</a> 中不允许使用相对路径。
</p>

<p>
在使用 non-trivial 生成器表达式的情况下，可以在 INSTALL_INTERFACE 表达式的参数内使用 INSTALL_PREFIX 表达式。它是一个替换标记，当由一个使用项目导入时，扩展为安装前缀。
</p>

<p>
include 目录的使用要求在构建树和安装树之间通常是不同的。 <code>BUILD_INTERFACE</code> 和 <code>INSTALL_INTERFACE</code> 生成器表达式可用于根据使用位置描述单独的使用要求。 <code>INSTALL_INTERFACE</code>  表达式中允许相对路径，并相对于安装前缀进行解释。例如：
</p>
<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">add_library</span>(ClimbingStats climbingstats.cpp)
<span style="color: #ffd700;">target_include_directories</span>(ClimbingStats INTERFACE
  $&lt;BUILD_INTERFACE:${<span style="color: #ff8700;">CMAKE_CURRENT_BINARY_DIR</span>}/generated&gt;
  $&lt;INSTALL_INTERFACE:/absolute/path&gt;
  $&lt;INSTALL_INTERFACE:relative/path&gt;
  $&lt;INSTALL_INTERFACE:$&lt;INSTALL_PREFIX&gt;/$&lt;CONFIG&gt;/generated&gt;
)
</pre>
</div>

<p>
有两个与 include 目录使用要求相关的便利 API。<a href="https://cmake.org/cmake/help/v3.10/variable/CMAKE_INCLUDE_CURRENT_DIR_IN_INTERFACE.html#variable:CMAKE_INCLUDE_CURRENT_DIR_IN_INTERFACE">CMAKE_INCLUDE_CURRENT_DIR_IN_INTERFACE</a> 变量可以被启用，对于每个受影响的目标，其效果等同于：
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">set_property</span>(TARGET tgt APPEND PROPERTY INTERFACE_INCLUDE_DIRECTORIES
  $&lt;BUILD_INTERFACE:${<span style="color: #ff8700;">CMAKE_CURRENT_SOURCE_DIR</span>};${<span style="color: #ff8700;">CMAKE_CURRENT_BINARY_DIR</span>}&gt;
)
</pre>
</div>
<p>
对于安装目标的便利是带有 <code>INCLUDES DESTINATION</code> 组件的 <a href="https://cmake.org/cmake/help/v3.10/command/install.html#command:install">install(TARGETS)</a> 命令：
</p>
<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">install</span>(TARGETS foo bar bat EXPORT tgts ${<span style="color: #ff8700;">dest_args</span>}
  INCLUDES DESTINATION include
)
<span style="color: #ffd700;">install</span>(EXPORT tgts ${<span style="color: #ff8700;">other_args</span>})
<span style="color: #ffd700;">install</span>(FILES ${<span style="color: #ff8700;">headers</span>} DESTINATION include)
</pre>
</div>
<p>
这相当于在由 <a href="https://cmake.org/cmake/help/v3.10/command/install.html#command:install">install(EXPORT)</a> 生成时，将 <code>${CMAKE_INSTALL_PREFIX}/include</code> 附加到每个已安装的 IMPORTED 目标的 <a href="https://cmake.org/cmake/help/v3.10/prop_tgt/INTERFACE_INCLUDE_DIRECTORIES.html#prop_tgt:INTERFACE_INCLUDE_DIRECTORIES">INTERFACE_INCLUDE_DIRECTORIES</a>。
</p>

<p>
当使用 <a href="https://cmake.org/cmake/help/v3.10/manual/cmake-buildsystem.7.html#imported-targets">imported target</a> 的 <a href="https://cmake.org/cmake/help/v3.10/prop_tgt/INTERFACE_INCLUDE_DIRECTORIES.html#prop_tgt:INTERFACE_INCLUDE_DIRECTORIES">INTERFACE_INCLUDE_DIRECTORIES</a> 时，属性中的条目将被视为 SYSTEM include 目录，就像它们在依赖的 <a href="https://cmake.org/cmake/help/v3.10/prop_tgt/INTERFACE_SYSTEM_INCLUDE_DIRECTORIES.html#prop_tgt:INTERFACE_SYSTEM_INCLUDE_DIRECTORIES">INTERFACE_SYSTEM_INCLUDE_DIRECTORIES</a> 中一样。这可能会导致在这些目录中找到头的编译器警告的省略。这种行为可以通过在 <a href="https://cmake.org/cmake/help/latest/manual/cmake-buildsystem.7.html#imported-targets">Imported Targets</a> 的使用者上设置 <a href="https://cmake.org/cmake/help/v3.10/prop_tgt/NO_SYSTEM_FROM_IMPORTED.html#prop_tgt:NO_SYSTEM_FROM_IMPORTED">NO_SYSTEM_FROM_IMPORTED</a> 目标属性来控制。
</p>

<p>
如果二进制目标与 Mac OX 框架传递链接，则框架的 <code>Headers</code> 目录也会被视为使用要求。这与将框架目录作为include目录传递具有相同的效果。
</p>
</div>
</div>

<div id="outline-container-org9dfdfb1" class="outline-3">
<h3 id="org9dfdfb1"><span class="section-number-3">3.7</span> 链接库和生成表达式(Link Libraries and Generator Expressions)</h3>
<div class="outline-text-3" id="text-3-7">
<p>
与构建规范一样，可以用生成器表达式条件来指定 <a href="https://cmake.org/cmake/help/latest/prop_tgt/LINK_LIBRARIES.html#prop_tgt:LINK_LIBRARIES">链接库(link libraries)</a> 。但是，由于使用需求的消耗是基于链接依赖关系的收集，所以链接依赖必须形成“有向无环图”。也就是说，如果链接到目标依赖于目标属性的值，那么该目标属性可能不依赖于链接的依赖项：
</p>
<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">add_library</span>(lib1 lib1.cpp)
<span style="color: #ffd700;">add_library</span>(lib2 lib2.cpp)
<span style="color: #ffd700;">target_link_libraries</span>(lib1 PUBLIC
  $&lt;$&lt;TARGET_PROPERTY:POSITION_INDEPENDENT_CODE&gt;:lib2&gt;
)
<span style="color: #ffd700;">add_library</span>(lib3 lib3.cpp)
<span style="color: #ffd700;">set_property</span>(TARGET lib3 PROPERTY INTERFACE_POSITION_INDEPENDENT_CODE ON)

<span style="color: #ffd700;">add_executable</span>(exe1 exe1.cpp)
<span style="color: #ffd700;">target_link_libraries</span>(exe1 lib1 lib3)
</pre>
</div>
<p>
由于 exe1 目标的 <a href="https://cmake.org/cmake/help/v3.10/prop_tgt/POSITION_INDEPENDENT_CODE.html#prop_tgt:POSITION_INDEPENDENT_CODE">POSITION_INDEPENDENT_CODE</a> 属性的值取决于链接库(lib3)，因此，并且链接 exe1 的边缘由相同的 POSITION_INDEPENDENT_CODE 属性确定，上面的依赖关系图包含一个循环。cmake(1)在这种情况下发出一个诊断。
</p>
</div>
</div>

<div id="outline-container-org53db583" class="outline-3">
<h3 id="org53db583"><span class="section-number-3">3.8</span> 输出(Output Artifacts)</h3>
<div class="outline-text-3" id="text-3-8">
<p>
由 <a href="https://cmake.org/cmake/help/v3.10/command/add_library.html#command:add_library">add_library()</a> 和 <a href="https://cmake.org/cmake/help/v3.10/command/add_executable.html#command:add_executable">add_executable()</a> 命令创建的构建系统目标会创建规则来产生二进制输出。二进制文件的确切输出位置只能在生成时确定，因为它可能依赖于构建配置和链接依赖项的连接语言等。 <code>TARGET_FILE</code> ， <code>TARGET_LINKER_FILE</code> 和相关表达式可用于访问生成的二进制文件的名称和位置。但是，这些表达式不适用于 <code>OBJECT</code> 库，因为这些库没有生成与表达式相关的单个文件。
</p>

<p>
可以由目标构建三种输出工件，如以下部分中所述。它们的分类在DLL平台和非DLL平台之间有所不同。包括Cygwin在内的所有基于Windows的系统都是DLL平台。
</p>
</div>

<div id="outline-container-orgfe3cc23" class="outline-4">
<h4 id="orgfe3cc23"><span class="section-number-4">3.8.1</span> 运行时输出工件（Runtime Output Artifacts）</h4>
<div class="outline-text-4" id="text-3-8-1">
<p>
构建系统目标的运行时输出工件可能是：
</p>
<ul class="org-ul">
<li>由 <a href="https://cmake.org/cmake/help/v3.10/command/add_executable.html#command:add_executable">add_executable()</a> 命令创建的可执行目标的可执行文件(例如.exe)。</li>
<li>在 DLL 平台上：使用 SHARED 选项通过 <a href="https://cmake.org/cmake/help/v3.10/command/add_library.html#command:add_library">add_library()</a> 命令创建的共享库目标的可执行文件(例如.dll)。</li>
</ul>

<p>
<a href="https://cmake.org/cmake/help/v3.10/prop_tgt/RUNTIME_OUTPUT_DIRECTORY.html#prop_tgt:RUNTIME_OUTPUT_DIRECTORY">RUNTIME_OUTPUT_DIRECTORY</a> 和 <a href="https://cmake.org/cmake/help/v3.10/prop_tgt/RUNTIME_OUTPUT_NAME.html#prop_tgt:RUNTIME_OUTPUT_NAME">RUNTIME_OUTPUT_NAME</a> 目标属性可用于控制构建树中的运行时输出工件位置和名称。
</p>
</div>
</div>

<div id="outline-container-org036d67b" class="outline-4">
<h4 id="org036d67b"><span class="section-number-4">3.8.2</span> 库输出工件（Library Output Artifacts）</h4>
<div class="outline-text-4" id="text-3-8-2">
<p>
构建系统目标的库输出工件可能是：
</p>
<ul class="org-ul">
<li>由带有 <code>MODULE</code> 选项的 <a href="https://cmake.org/cmake/help/v3.10/command/add_library.html#command:add_library">add_library()</a> 命令创建的模块库目标的可加载模块文件(例如.dll 或.so)。</li>
<li>在非 DLL 平台上：由带有 SHARED 选项 <a href="https://cmake.org/cmake/help/v3.10/command/add_library.html#command:add_library">add_library()</a> 命令创建的共享共享库目标的共享库文件(例如.so 或.dylib)。</li>
</ul>

<p>
<a href="https://cmake.org/cmake/help/v3.10/prop_tgt/LIBRARY_OUTPUT_DIRECTORY.html#prop_tgt:LIBRARY_OUTPUT_DIRECTORY">LIBRARY_OUTPUT_DIRECTORY</a> 和 <a href="https://cmake.org/cmake/help/v3.10/prop_tgt/LIBRARY_OUTPUT_NAME.html#prop_tgt:LIBRARY_OUTPUT_NAME">LIBRARY_OUTPUT_NAME</a> 目标属性可用于控制构建树中的库输出工件位置和名称。
</p>
</div>
</div>

<div id="outline-container-org5d66ffa" class="outline-4">
<h4 id="org5d66ffa"><span class="section-number-4">3.8.3</span> 存档输出工件（Archive Output Artifacts）</h4>
<div class="outline-text-4" id="text-3-8-3">
<p>
构建系统目标的归档输出工件可能是：
</p>
<ul class="org-ul">
<li>静态库文件(例如.lib 或.a)，由带有 STATIC 选项的 <a href="https://cmake.org/cmake/help/v3.10/command/add_library.html#command:add_library">add_library()</a> 命令创建的静态库目标。</li>
<li>在 DLL 平台上：由带有 SHARED 选项 <a href="https://cmake.org/cmake/help/v3.10/command/add_library.html#command:add_library">add_library()</a> 命令创建的共享库目标的导入库文件(例如.lib)。只有在库导出至少一个非托管符号时，才能保证该文件存在。</li>
<li>在 DLL 平台上：当设置了 <a href="https://cmake.org/cmake/help/v3.10/prop_tgt/ENABLE_EXPORTS.html#prop_tgt:ENABLE_EXPORTS">ENABLE_EXPORTS</a> 目标属性时，由 <a href="https://cmake.org/cmake/help/v3.10/command/add_executable.html#command:add_executable">add_executable()</a> 命令创建的可执行目标的导入库文件(例如.lib)。</li>
</ul>

<p>
<a href="https://cmake.org/cmake/help/v3.10/prop_tgt/ARCHIVE_OUTPUT_DIRECTORY.html#prop_tgt:ARCHIVE_OUTPUT_DIRECTORY">ARCHIVE_OUTPUT_DIRECTORY</a> 和 <a href="https://cmake.org/cmake/help/v3.10/prop_tgt/ARCHIVE_OUTPUT_NAME.html#prop_tgt:ARCHIVE_OUTPUT_NAME">ARCHIVE_OUTPUT_NAME</a> 目标属性可用于控制构建树中的归档输出工件位置和名称。
</p>
</div>
</div>

<div id="outline-container-org35dbb79" class="outline-4">
<h4 id="org35dbb79"><span class="section-number-4">3.8.4</span> 目录范围命令（Directory-Scoped Commands）</h4>
<div class="outline-text-4" id="text-3-8-4">
<p>
<a href="https://cmake.org/cmake/help/v3.10/command/target_include_directories.html#command:target_include_directories">target_include_directories()</a>，<a href="https://cmake.org/cmake/help/v3.10/command/target_compile_definitions.html#command:target_compile_definitions">target_compile_definitions()</a> 和 <a href="https://cmake.org/cmake/help/v3.10/command/target_compile_options.html#command:target_compile_options">target_compile_options()</a> 命令一次只对一个目标产生影响。<a href="https://cmake.org/cmake/help/v3.10/command/add_definitions.html#command:add_definitions">add_definitions()</a>，<a href="https://cmake.org/cmake/help/v3.10/command/add_compile_options.html#command:add_compile_options">add_compile_options()</a> 和 <a href="https://cmake.org/cmake/help/v3.10/command/include_directories.html#command:include_directories">include_directories()</a> 函数具有类似的功能，但为了方便，在目录范围而不是目标范围内运行。
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org3cb5dd5" class="outline-2">
<h2 id="org3cb5dd5"><span class="section-number-2">4</span> 伪目标(Pseudo Targets)</h2>
<div class="outline-text-2" id="text-4">
<p>
某些目标类型不代表构建系统的输出，而只代表输入，如外部依赖关系，别名或其他非构建工件。伪目标未在生成的构建系统中表示。
</p>
</div>

<div id="outline-container-org5c2216a" class="outline-3">
<h3 id="org5c2216a"><span class="section-number-3">4.1</span> 导入的目标(Imported Target)</h3>
<div class="outline-text-3" id="text-4-1">
<p>
<a href="https://cmake.org/cmake/help/v3.10/prop_tgt/IMPORTED.html#prop_tgt:IMPORTED">IMPORTED</a> 目标表示预先存在的依赖关系。通常这些目标由上游软件包定义，应该被视为不可变的。<a href="https://cmake.org/cmake/help/v3.10/prop_tgt/IMPORTED.html#prop_tgt:IMPORTED">IMPORTED</a> 目标不能用在 <a href="https://cmake.org/cmake/help/v3.10/command/target_include_directories.html#command:target_include_directories">target_include_directories()</a>，<a href="https://cmake.org/cmake/help/v3.10/command/target_compile_definitions.html#command:target_compile_definitions">target_compile_definitions()</a> 和 <a href="https://cmake.org/cmake/help/v3.10/command/target_compile_options.html#command:target_compile_options">target_compile_options()</a> 命令的左侧，因为那将试图修改它。<a href="https://cmake.org/cmake/help/v3.10/prop_tgt/IMPORTED.html#prop_tgt:IMPORTED">IMPORTED</a> 目标被设计为仅用于这些命令的右侧。
</p>

<p>
<a href="https://cmake.org/cmake/help/v3.10/prop_tgt/IMPORTED.html#prop_tgt:IMPORTED">IMPORTED</a> 目标可能具有与二进制目标相同的使用要求属性，如 <code>INTERFACE_INCLUDE_DIRECTORIES，INTERFACE_COMPILE_DEFINITIONS，INTERFACE_COMPILE_OPTIONS，INTERFACE_LINK_LIBRARIES 和 INTERFACE_POSITION_INDEPENDENT_CODE</code> 。
</p>

<p>
可以从 <a href="https://cmake.org/cmake/help/v3.10/prop_tgt/IMPORTED.html#prop_tgt:IMPORTED">IMPORTED</a> 目标读取 <a href="https://cmake.org/cmake/help/v3.10/prop_tgt/LOCATION.html#prop_tgt:LOCATION">LOCATION</a> ，尽管很少有理由这么做。诸如 <a href="https://cmake.org/cmake/help/v3.10/command/add_custom_command.html#command:add_custom_command">add_custom_command()</a> 之类的命令可以透明地使用 <a href="https://cmake.org/cmake/help/v3.10/prop_tgt/IMPORTED.html#prop_tgt:IMPORTED">IMPORTED</a> <a href="https://cmake.org/cmake/help/v3.10/prop_tgt/TYPE.html#prop_tgt:TYPE">EXECUTABLE</a> 目标作为 <code>COMMAND</code> 可执行文件。
</p>

<p>
<a href="https://cmake.org/cmake/help/v3.10/prop_tgt/IMPORTED.html#prop_tgt:IMPORTED">IMPORTED</a> 目标的定义范围是定义它的目录。它可以从子目录访问和使用，但不能从父目录或兄弟目录中访问和使用。范围等同 cmake 变量。
</p>

<p>
也可以定义一个可在构建系统中全局访问的 <code>GLOBAL</code> <a href="https://cmake.org/cmake/help/v3.10/prop_tgt/IMPORTED.html#prop_tgt:IMPORTED">IMPORTED</a> 目标。
</p>

<p>
有关创建包含 <a href="https://cmake.org/cmake/help/v3.10/prop_tgt/IMPORTED.html#prop_tgt:IMPORTED">IMPORTED</a> 目标的包的更多信息，请参阅 <a href="https://cmake.org/cmake/help/v3.10/manual/cmake-packages.7.html#manual:cmake-packages(7)">cmake-packages(7)</a> 手册。
</p>
</div>
</div>

<div id="outline-container-org85dde73" class="outline-3">
<h3 id="org85dde73"><span class="section-number-3">4.2</span> 别名目标(Alias Targets)</h3>
<div class="outline-text-3" id="text-4-2">
<p>
<code>ALIAS</code> 目标是一个名称，可以在只读上下文中与二进制目标名称互换使用。 <code>ALIAS</code> 目标的主要用途是库附带的单元测试可执行文件，它可以是同一构建系统的一部分，也可以根据用户配置单独构建。
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">add_library</span>(lib1 lib1.cpp)
<span style="color: #ffd700;">install</span>(TARGETS lib1 EXPORT lib1Export ${<span style="color: #ff8700;">dest_args</span>})
<span style="color: #ffd700;">install</span>(EXPORT lib1Export NAMESPACE Upstream:: ${<span style="color: #ff8700;">other_args</span>})

<span style="color: #ffd700;">add_library</span>(Upstream::lib1 ALIAS lib1)
</pre>
</div>

<p>
在另一个目录中，我们可以无条件地链接到 <code>Upstream::lib1</code> 目标，它可能是包中的 IMPORTED 目标，或者是作为同一个构建系统的部分的 ALIAS 目标。
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #a1db00;">if</span> (NOT TARGET Upstream::lib1)
  <span style="color: #ffd700;">find_package</span>(lib1 REQUIRED)
<span style="color: #a1db00;">endif</span>()
<span style="color: #ffd700;">add_executable</span>(exe1 exe1.cpp)
<span style="color: #ffd700;">target_link_libraries</span>(exe1 Upstream::lib1)
</pre>
</div>

<p>
<code>ALIAS</code> 目标不具有可变性，可安装性或可导出性。对构建系统描述来说，它们完全是本地的。通过读取 <a href="https://cmake.org/cmake/help/v3.10/prop_tgt/ALIASED_TARGET.html#prop_tgt:ALIASED_TARGET">ALIASED_TARGET</a> 属性，可以判断名称是否是别名。
</p>
<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">get_target_property</span>(_aliased Upstream::lib1 ALIASED_TARGET)
<span style="color: #a1db00;">if</span>(_aliased)
  <span style="color: #ffd700;">message</span>(STATUS <span style="color: #ff4ea3;">"The name Upstream::lib1 is an ALIAS for ${</span><span style="color: #ff8700;">_aliased</span><span style="color: #ff4ea3;">}."</span>)
<span style="color: #a1db00;">endif</span>()
</pre>
</div>
</div>
</div>

<div id="outline-container-org2fcf885" class="outline-3">
<h3 id="org2fcf885"><span class="section-number-3">4.3</span> 接口库(Interface Libraries)</h3>
<div class="outline-text-3" id="text-4-3">
<p>
<code>INTERFACE</code> 目标没有 <a href="https://cmake.org/cmake/help/latest/prop_tgt/LOCATION.html#prop_tgt:LOCATION">LOCATION</a> 并且是可变的，但在其他方面类似于 IMPORTED 目标。
</p>

<p>
它可以指定使用要求，例如 <code>INTERFACE_INCLUDE_DIRECTORIES，INTERFACE_COMPILE_DEFINITIONS，INTERFACE_COMPILE_OPTIONS，INTERFACE_LINK_LIBRARIES，INTERFACE_SOURCES 和 INTERFACE_POSITION_INDEPENDENT_CODE。只有 target_include_directories()，target_compile_definitions()，target_compile_options()，target_sources()和 target_link_libraries()</code> 命令的 <code>INTERFACE</code> 模式可以与 <code>INTERFACE</code> 库一起使用。
</p>

<p>
<code>INTERFACE</code> 库的主要用途说明仅包含头文件的库。
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">add_library</span>(Eigen INTERFACE)
<span style="color: #ffd700;">target_include_directories</span>(Eigen INTERFACE
  $&lt;BUILD_INTERFACE:${<span style="color: #ff8700;">CMAKE_CURRENT_SOURCE_DIR</span>}/src&gt;
  $&lt;INSTALL_INTERFACE:include/Eigen&gt;
)

<span style="color: #ffd700;">add_executable</span>(exe1 exe1.cpp)
<span style="color: #ffd700;">target_link_libraries</span>(exe1 Eigen)
</pre>
</div>
<p>
这里，Eigen 目标的使用需求在编译时被消耗和使用，但对链接没有影响。
</p>

<p>
另一个用例是针对使用要求采用完全以目标为中心的设计：
</p>
<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">add_library</span>(pic_on INTERFACE)
<span style="color: #ffd700;">set_property</span>(TARGET pic_on PROPERTY INTERFACE_POSITION_INDEPENDENT_CODE ON)
<span style="color: #ffd700;">add_library</span>(pic_off INTERFACE)
<span style="color: #ffd700;">set_property</span>(TARGET pic_off PROPERTY INTERFACE_POSITION_INDEPENDENT_CODE OFF)

<span style="color: #ffd700;">add_library</span>(enable_rtti INTERFACE)
<span style="color: #ffd700;">target_compile_options</span>(enable_rtti INTERFACE
  $&lt;$&lt;OR:$&lt;COMPILER_ID:GNU&gt;,$&lt;COMPILER_ID:Clang&gt;&gt;:-rtti&gt;
)

<span style="color: #ffd700;">add_executable</span>(exe1 exe1.cpp)
<span style="color: #ffd700;">target_link_libraries</span>(exe1 pic_on enable_rtti)
</pre>
</div>
<p>
这样，exe1 的构建规范完全被表示为链接目标，并且编译器特定标志的复杂性被封装在 INTERFACE 库目标中。
</p>

<p>
允许在 INTERFACE 库上设置或读取的属性有：
</p>
<ul class="org-ul">
<li>Properties matching INTERFACE_*</li>
<li>Built-in properties matching COMPATIBLE_INTERFACE_*</li>
<li>EXPORT_NAME</li>
<li>IMPORTED</li>
<li>NAME</li>
<li>Properties matching IMPORTED_LIBNAME_*</li>
<li>Properties matching MAP_IMPORTED_CONFIG_*</li>
</ul>

<p>
INTERFACE 库可以被安装和导出。它们引用的任何内容必须单独安装：
</p>
<div class="org-src-container">
<pre class="src src-cmake"><span style="color: #ffd700;">add_library</span>(Eigen INTERFACE)
<span style="color: #ffd700;">target_include_directories</span>(Eigen INTERFACE
  $&lt;BUILD_INTERFACE:${<span style="color: #ff8700;">CMAKE_CURRENT_SOURCE_DIR</span>}/src&gt;
  $&lt;INSTALL_INTERFACE:include/Eigen&gt;
)

<span style="color: #ffd700;">install</span>(TARGETS Eigen EXPORT eigenExport)
<span style="color: #ffd700;">install</span>(EXPORT eigenExport NAMESPACE Upstream::
  DESTINATION lib/cmake/Eigen
)
<span style="color: #ffd700;">install</span>(FILES
    ${<span style="color: #ff8700;">CMAKE_CURRENT_SOURCE_DIR</span>}/src/eigen.h
    ${<span style="color: #ff8700;">CMAKE_CURRENT_SOURCE_DIR</span>}/src/vector.h
    ${<span style="color: #ff8700;">CMAKE_CURRENT_SOURCE_DIR</span>}/src/matrix.h
  DESTINATION include/Eigen
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: phenix3443</p>
<p class="email">Email: <a href="mailto:phenix3443+github@gmail.com">phenix3443+github@gmail.com</a></p>
<p class="date">Created: 2020-04-26 日 10:54</p>
<p class="validation"></p>
</div>
</body>
</html>
